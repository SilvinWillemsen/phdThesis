\input{setup/preamble.tex}% package inclusion and set up of the document
\input{setup/hyphenations.tex}% 
\input{setup/macros.tex}% my new macros

\begin{document}
\DeclareGraphicsExtensions{.png,.jpg,.pdf, eps.}
%frontmatter
\frontmatter
\pagestyle{empty} %disable headers and footers
\pagenumbering{roman} %use roman page numbering in the frontmatter
\input{frontmatter/frontpage}
\input{frontmatter/colophon}
\input{frontmatter/cv}
\input{frontmatter/acknowledgements}
\input{frontmatter/listOfPublications}
\input{frontmatter/abstract}
\cleardoublepage
\pdfbookmark[0]{Contents}{label:contents}
\pagestyle{fancy} %enable headers and footers again
\tableofcontents
\listoftodos
\input{frontmatter/preface}
\cleardoublepage

\def\citeP[#1]{[\ref{paper:#1}]}

\def\ctxt{\text{c}} %connection subscript (text)
\def\stxt{\text{s}} %string subscript (text)
\def\ptxt{\text{p}} %plate subscript (text)

% states
\def\uln{u_l^n}
\def\wln{w_l^n}
\def\un{u^n}
\def\ulmn{u_{l,m}^n}


% bold symbols (state vectors and matrices)
\def\u{\mathbf{u}}
\def\w{\mathbf{w}}
\def\I{\mathbf{I}}
\def\A{\mathbf{A}}
\def\B{\mathbf{B}}
\def\C{\mathbf{C}}
\def\Q{\mathbf{Q}}

% continuous operators
\def\ptt{\partial_t^2} 
\def\pxx{\partial_x^2}
\def\pxxx{\partial_x^3}
\def\pxxxx{\partial_x^4}

\def\pyy{\partial_y^2}

\def\pt{\partial_t} 
\def\px{\partial_x} 
\def\py{\partial_y} 

% discrete operators
\def\dtt{\delta_{tt}} 
\def\dxx{\delta_{xx}}
\def\dxxxx{\delta_{xxxx}}

\def\dtd{\delta_{t\cdot}} 
\def\dtp{\delta_{t+}} 
\def\dtm{\delta_{t-}} 

\def\dxd{\delta_{x\cdot}} 
\def\dxp{\delta_{x+}} 
\def\dxm{\delta_{x-}} 

\def\mtt{\mu_{tt}} 
\def\mtd{\mu_{t\cdot}} 
\def\mtp{\mu_{t+}} 
\def\mtm{\mu_{t-}} 

\def\mxx{\mu_{xx}} 
\def\mxd{\mu_{x\cdot}} 
\def\mxp{\mu_{x+}} 
\def\mxm{\mu_{x-}} 

\def\dTwoD{\delta_{\Delta}}

% matrix operators
\def\Dxx{\mathbf{D}_{xx}}
\def\Dxxxx{\mathbf{D}_{xxxx}}


% often-used variables
\def\sz{\sigma_{0}}
\def\so{\sigma_{1}}

\def\szX[#1]{\sigma_{0{#1}}}
\def\soX[#1]{\sigma_{1{#1}}}

\def\fs{f_\text{s}}

% mathcals
\def\D{\mathcal{D}}
\def\L{\mathcal{L}}
\def\O{\mathcal{O}}

% flooring ceiling
\def\floor[#1]{\left\lfloor #1 \right\rfloor}
\def\ceil[#1]{\left\lceil #1 \right\rceil}


\def\th{\textsuperscript{th} }
%mainmatter
\mainmatter
\part{Introduction}\label{part:introduction}
\input{introduction/introduction}

\part{Resonators}\label{part:resonators}
\input{resonators/resonators}

\part{Exciters}\label{part:exciters}
\input{exciters/exciters}

\part{Interactions}\label{part:interactions}
\input{interactions/interactions}

\part{Dynamic Grids}\label{part:dynamic}
\input{dynamic/dynamic}

\part{Real-Time Implementation and Control}\label{part:realtime}
\input{realtime/realtime}

\part{Complete Instruments}\label{part:instrument}
\input{instrument/instrument}

\pagebreak

% \nocite{*} %only if you want all references in there
\todo{check whether all references are used}
\makeatletter
\renewenvironment{thebibliography}[1]
     {\chapter*{\bibname}%
      \@mkboth{\MakeUppercase\bibname}{\MakeUppercase\bibname}%
      \list{\@biblabel{\@arabic\c@enumiv}}%
           {\settowidth\labelwidth{\@biblabel{#1}}%
            \leftmargin\labelwidth
            \advance\leftmargin\labelsep
            \@openbib@code
            \usecounter{enumiv}%
            \let\p@enumiv\@empty
            \renewcommand\theenumiv{\@arabic\c@enumiv}}%
      \sloppy
      \clubpenalty4000
      \@clubpenalty \clubpenalty
      \widowpenalty4000%
      \sfcode`\.\@m}
     {\def\@noitemerr
       {\@latex@warning{Empty `thebibliography' environment}}%
      \endlist}
\makeatother

{\bibliographystyle{IEEEtranS}\bibliography{bib/mybib}}
\addcontentsline{toc}{chapter}{References}


%backmatter
\newif\ifapp
\apptrue % uncomment to include appendices

\newif\ifpapers
% \paperstrue % uncomment to include appendices

\ifapp
  \renewcommand\thesection{\thechapter.\arabic{section}}
  \begin{subappendices}
    \begin{appendices}
      \part{Appendix}
      \input{appendices/appendices}   
    \end{appendices}
    \begin{appendices}
      \renewcommand\appendixname{Paper} 
      \setcounter{chapter}{0} % reset stuff
      \renewcommand\thesection{\thechapter.\arabic{section}}
      \part{Papers}\label{part:papers}
      \input{papers/paperErrata}
      \pagestyle{plain}
      \input{papers/papers.tex}
      \pagestyle{fancy}
      % \input{papers/paperA/paperA.tex}
    \end{appendices}
  \end{subappendices}
\fi
\titleformat{%command
  \chapter
}[%shape
display%
]{%format
  \normalfont\huge 
}{%label
  \begin{center}\color{aaublue}\chaptertitlename\ \thechapter\end{center}
}{%style
  1cm
}{%code before title
  \thispagestyle{empty}\begin{center}\Large
[%code after title
]
  \end{center}}

% \includepaper{papers/paperA/paperA}
% \includepaper{papers/paperB/paperB}
\end{document}
